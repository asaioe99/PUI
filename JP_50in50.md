# 50CVEを50日間で　-Adobe Readerをファジング-

2018年12月12日（木）

Research By: ヨアヴ・アロン、ネタネル・ベンシモン

## はじめに

2017年は、脆弱性をめぐる状況の転換点であった。この年に報告された新たな脆弱性の数は約14,000件で、前年の2倍以上である（下表参照）。この理由として考えられるのは、「ファザー」とも呼ばれる自動脆弱性発見ツールの普及が進んだことである。

![fig1-1](https://user-images.githubusercontent.com/77034428/163527737-60d6a7a9-b2be-4fac-a75e-72adcd637122.png)

ファザーの存在自体は、20年以上前からあるもので、決して新しいものではない。しかし、ファザーが成長したことは事実である。より高性能になり、より身近になり、全体的に成熟してきたのである。しかし、ファザーを使うことは「ダークアート」と呼ばれ、多くの研究者はファザーを使うのが面倒だと考え、手を出さないのが現状である。

以上のことを踏まえれば、我々は当然問うべきである。「ファザーを使ってより多くの脆弱性を発見する研究者が増えている。しかし、すべての研究者がファザーを使い、すべての脆弱性を見つけているのだろうか？　「FUZZ」と書かれた大きなボタンを押す者を待っている、収穫を待つ実り豊かな果実がどれだけあるのだろうか？」

それを確かめるために、私たちは思いつく限りの最もありふれた実験を組み立てた。最も一般的なWindowsファジングフレームワークの1つであるWinAFLを使用し、世界で最も人気のあるソフトウェア製品の1つであるAdobe Readerをターゲットにした。コードのリバースエンジニアリング、脆弱性のあるライブラリの探索、ハーネスの作成、そして最後にファザーの実行まで、すべての作業に50日という期間を設定した。

その結果に私たちは驚かされた。この50日間で、Adobe Readerに50以上の新しい脆弱性を発見することができたのである。平均すると1日に1件の脆弱性が発見されたことになり、この種の調査としてはかなり異例なペースである。

本論文では、この研究の全貌を明らかにする。検索範囲を拡大するために用いた新しい方法論、WinAFLに施した改良、そして最終的に得られた洞察について紹介する。

## WinAFLとはなにであるか？

AFLはカバレッジガイド付き遺伝的ファザーであり、強固な実装と巧妙な発見的手法により、実際のソフトウェアのバグの発見に成功していることが良く実証されている。

WinAFLは、Ivan Fratric (Google Project Zero)によって作成・維持されているWindows用のAFLのフォークである。Windows版では、クローズドソースのバイナリを標的にできるように、異なる方式の計装を使用している。

AFLの仕組みについて詳しく書かれている[AFLの技術文書](https://github.com/google/AFL/blob/master/docs/technical_details.txt)を読むことを推奨する。それにより、このツールの欠点を把握し、不具合が生じた際のデバッグに役立つはずだ。
